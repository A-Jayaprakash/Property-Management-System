<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Property Management System</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Property Management System</h1>
        <p>Manage your properties efficiently and effectively</p>
      </div>

      <div class="actions-bar">
        <div class="search-box">
          <input
            type="text"
            id="searchInput"
            placeholder="Search properties..."
          />
        </div>
        <div style="display: flex; gap: 15px; align-items: center">
          <button
            class="btn theme-toggle-btn"
            id="themeToggle"
            onclick="toggleTheme()"
            title="Toggle Theme"
          >
            <span id="themeIcon">ðŸŒ™</span>
            <span id="themeText">Dark Mode</span>
          </button>
          <button class="btn btn-primary" onclick="openAddModal()">
            âž• Add New Property
          </button>
        </div>
      </div>

      <div id="errorMessage" class="error-message"></div>
      <div id="successMessage" class="success-message"></div>

      <div id="loadingIndicator" class="loading">Loading properties...</div>

      <div id="propertiesContainer" class="properties-grid"></div>
    </div>

    <!-- Add/Edit Property Modal -->
    <div id="propertyModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Add New Property</h2>
          <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div class="modal-body">
          <form id="propertyForm">
            <div class="form-group">
              <label for="propertyName">Property Name *</label>
              <input type="text" id="propertyName" name="name" required />
            </div>

            <div class="form-group">
              <label for="propertyAddress">Address *</label>
              <input type="text" id="propertyAddress" name="address" required />
            </div>

            <div class="form-group">
              <label for="propertyLocality">Locality</label>
              <input type="text" id="propertyLocality" name="locality" />
            </div>

            <div class="form-group">
              <label for="propertyType">Property Type *</label>
              <select id="propertyType" name="type" required>
                <option value="">Select Type</option>
                <option value="Residential">Residential</option>
                <option value="Commercial">Commercial</option>
              </select>
            </div>

            <div class="form-group">
              <label for="unitCount">Unit Count *</label>
              <input
                type="number"
                id="unitCount"
                name="unitCount"
                min="1"
                required
              />
            </div>

            <div
              style="
                display: flex;
                gap: 15px;
                justify-content: flex-end;
                margin-top: 30px;
              "
            >
              <button
                type="button"
                class="btn btn-secondary"
                onclick="closeModal()"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-success" id="submitBtn">
                Save Property
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      // Global variables
      let properties = [];
      let currentEditId = null;
      const API_BASE_URL = "http://localhost:3000/api/properties";

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        loadProperties();
        setupSearchListener();
        setupFormListener();
      });

      window.onclick = function (event) {
        const modal = document.getElementById("propertyModal");
        if (event.target === modal) {
          closeModal();
        }
      };
    </script>
    <script src="escapeHTML.js"></script>
    <script src="showLoading.js"></script>
    <script src="showError.js"></script>
    <script src="showSuccess.js"></script>
    <script src="openModal.js"></script>
    <script src="closeModal.js"></script>
    <script src="formListener.js"></script>
    <script src="formSubmit.js"></script>
    <script src="searchListener.js"></script>
    <script src="filterProperties.js"></script>
    <script src="loadProperties.js"></script>
    <script src="deleteProperty.js"></script>
    <script src="renderProperties.js"></script>
    <script src="editProperty.js"></script>
    <script src="toggleTheme.js"></script>
  </body>
</html>
